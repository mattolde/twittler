<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>

    <div class="viewAllTweets" style="display:none;">
      <a href="#" id="back">Back</a>
    </div>

    <div class="tweets"></div>

    <script>

      $(document).ready(function() {

        var filter = 'all';
        
        function getTweets(user){
          if(user === 'all') {
            return streams.home;  
          } else {
            return streams.users[user];
          }
        }

        function displayTweets(tweets){
          for(var i = 0; i < tweets.length; i++) {
            var tweet = tweets[i];

            $('.tweets').append('<div><a href="#" class="user" data-username="' + tweet.user + '">@' + tweet.user + '</a> : ' + tweet.message + ' - Time: ' + tweet.created_at + '</div>');
          }
        }

        function viewUserTweets() {
          var tweets = getTweets(filter);
          $('.tweets').html('');
          displayTweets(tweets);
        }

        $(document).on('click', '.user', function(e) {
          e.preventDefault();
          filter = this.dataset.username;
          viewUserTweets();
          $('.viewAllTweets').show();
        });

        $(document).on('click', '#back', function(e){
          e.preventDefault();
          $('.viewAllTweets').hide();
          filter = 'all';
          viewUserTweets();
        });

        function refreshMessages(){
          viewUserTweets();
          setTimeout(function(){
            refreshMessages();
          }, 3000);        
        }

        refreshMessages();

      });

    </script>
  </body>
</html>
